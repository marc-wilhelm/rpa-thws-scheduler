<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THWS Scheduler</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="page-layout">
    <div class="content-block">
        <h1>THWS Scheduler</h1>
        <h2>Business School</h2>

        <div class="tabs">
            <div class="tab-button active" onclick="switchMainTab('options')">Aktionen</div>
            <div class="tab-button" onclick="switchMainTab('lecture-plans')">Vorlesungspläne</div>
        </div>

        <!-- Bereich für Aktionen -->
        <div id="options-tab" class="main-tab-content">
            <div id="options">
                <div class="option-card" onclick="selectOption('scrape')">
                    <div class="option-title">Vorlesungsplan importieren/aktualisieren</div>
                    <div class="option-description">Stellt eine Anfrage an die API, welche alle angegebenen Vorlesungspläne nach Modulen absucht (scrapt) und anschließend als JSON zurückgibt. Über diese JSON-Struktur wird dann iteriert, um alle Tage und Vorlesungen zu bekommen, wobei anschließend für jede Vorlesung ein Termin im Kalender neu eingetragen oder aktualisiert wird.</div>
                </div>

                <div class="option-card" onclick="selectOption('clear')">
                    <div class="option-title">Kalender leeren</div>
                    <div class="option-description">Löscht alle vorhandenen Termine aus deinem Kalender.</div>
                </div>
            </div>

            <!-- Neuer Bereich für Request-Content bei Scrape -->
            <div id="scrape-config" class="config-section" style="display: none;">
                <h3>Konfiguration für Vorlesungsplan</h3>
                
                <div class="input-tabs">
                    <div class="tab-button active" onclick="switchTab('structured')">Strukturierte Eingabe</div>
                    <div class="tab-button" onclick="switchTab('raw')">JSON (RAW)</div>
                </div>
                
                <!-- Strukturierte Eingabe -->
                <div id="structured-input" class="input-panel">
                    <div id="plans-container">
                        <div class="plan-item">
                            <div class="input-group">
                                <label for="plan-url-0">URL:</label>
                                <input type="text" id="plan-url-0" class="plan-url" placeholder="z.B. https://business.thws.de/fileadmin/share/vlplan/BBA%206%20SS%2025.html">
                            </div>
                            <div class="input-group">
                                <label for="plan-label-0">Label:</label>
                                <input type="text" id="plan-label-0" class="plan-label" placeholder="z.B. BBA 6">
                            </div>
                            <div class="input-group">
                                <label for="plan-filter-0">Filter (durch Komma getrennt):</label>
                                <input type="text" id="plan-filter-0" class="plan-filter" placeholder="z.B. PBA1, SPBA">
                            </div>
                            <button class="remove-plan" onclick="removePlan(0)" style="display: none;">Entfernen</button>
                        </div>
                    </div>
                    <button class="add-plan-button" onclick="addPlan()">+ Plan hinzufügen</button>
                </div>
                
                <!-- JSON RAW Eingabe -->
                <div id="raw-input" class="input-panel" style="display: none;">
                    <textarea id="json-input" placeholder='z.B.:
{
  "plans": [
    {
      "url": "https://business.thws.de/fileadmin/share/vlplan/BBA%206%20SS%2025.html",
      "label": "BBA 6",
      "filter": ["PBA1", "SPBA"]
    }
  ]
}'></textarea>
                    <div class="json-validation" id="json-validation"></div>
                </div>
            </div>

            <button id="execute" class="execute-button" disabled onclick="executeAction()">Ausführen</button>

            <div id="status" class="status"></div>
        </div>

        <!-- Bereich für Vorlesungspläne -->
        <div id="lecture-plans-tab" class="main-tab-content" style="display: none;">
            <div class="plan-search-container">
                <input type="text" id="plan-search-input" placeholder="Studiengang suchen..." oninput="searchLecturePlans()">
                <button id="load-plans-button" class="secondary-button" onclick="loadLecturePlans()">Vorlesungspläne laden</button>
            </div>
            
            <div id="plan-loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Lade Vorlesungspläne...</p>
            </div>
            
            <div id="plan-error" class="error-message" style="display: none;"></div>
            
            <div id="plans-container" style="display: none;">
                <div id="plans-list" class="plans-list"></div>
            </div>
            
            <div class="plan-help">
                <p><strong>Tipp:</strong> Klicke auf das <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> Symbol, um den Link zu kopieren. Klicke auf das <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg> Symbol, um den Plan zur Konfiguration hinzuzufügen.</p>
            </div>
        </div>
    </div>

    <div class="content-block">
        <h3>API Info</h3>
        <p><strong>URL:</strong><br><code>https://thws-scheduler.azurewebsites.net/api/schedule_scraper</code></p>

        <h4>Content-Request Format:</h4>
        <pre>{
  "plans": [
    {
      "url": "https://business.thws.de/fileadmin/share/vlplan/BBA%206%20SS%2025.html",
      "label": "BBA 6",
      "filter": ["PBA1", "SPBA"]
    },
    {
      "url": "https://business.thws.de/fileadmin/share/vlplan/BBW%206%20SS%2025.html",
      "label": "BBW 6",
      "filter": ["SP WINF"]
    }
  ]
}</pre>
    </div>
</div>

<footer class="footer">
    <div class="footer-content">
        <p>Dieses Projekt ist rein privat und steht in keiner Verbindung zu Dritten.<br>Alle Marken- und Namensrechte verbleiben bei ihren jeweiligen Eigentümern.</p>
    </div>
</footer>

<script src="script.js"></script>
<script src="lecture-scraper.js"></script>
</body>
</html>
